diff --git a/node_modules/primitive/browser.js b/node_modules/primitive/browser.js
index eea6707..35ff57a 100644
--- a/node_modules/primitive/browser.js
+++ b/node_modules/primitive/browser.js
@@ -39,6 +39,7 @@ export default async (opts) => {
     output,
     onStep,
     numSteps = 200,
+    log = () => {},
     ...rest
   } = opts
 
@@ -90,20 +91,23 @@ export default async (opts) => {
     }
   })
 
-  // TODO: clean this iteration up and use web workers
-  let current = 0
-  const update = () => {
-    console.log('step', current, '; score', model.score)
-    step(current)
-      .then((candidates) => {
-        if (candidates <= 0 || ++current >= numSteps) return
-
-        raf(update)
-      }, (err) => {
-        console.error('primitive error', err)
-      })
+  const rafStep = (curr) => new Promise((resolve, reject) =>
+    raf(() => step(curr).then(resolve).catch(reject)));
+
+  for (let s = 1; s <= numSteps; ++s) {
+    performance.mark(`step ${s}`)
+
+    const candidates = await rafStep(s)
+
+    log(`${s})`, {
+      time: performance.measure(`step ${s}`).duration,
+      candidates,
+      score: model.score
+    });
+
+    if (!candidates) break
   }
+  performance.clearMarks();
 
-  raf(update)
   return model
 }
diff --git a/node_modules/primitive/lib/color.js b/node_modules/primitive/lib/color.js
index f17e00c..cbfa0f8 100644
--- a/node_modules/primitive/lib/color.js
+++ b/node_modules/primitive/lib/color.js
@@ -1,4 +1,4 @@
-import chromatism from 'chromatism'
+import * as chromatism from 'chromatism'
 export default chromatism
 
 export const cssrgba = (color) => {
diff --git a/node_modules/primitive/lib/primitive.js b/node_modules/primitive/lib/primitive.js
index 70831ad..380c16b 100644
--- a/node_modules/primitive/lib/primitive.js
+++ b/node_modules/primitive/lib/primitive.js
@@ -52,7 +52,7 @@ export default async (opts) => {
   })
 
   const step = async (index) => {
-    await onStep(model, step)
+    await onStep(model, index)
 
     const candidates = model.step({
       shapeType,
diff --git a/node_modules/primitive/lib/shapes/factory.js b/node_modules/primitive/lib/shapes/factory.js
index 7974a93..573531b 100644
--- a/node_modules/primitive/lib/shapes/factory.js
+++ b/node_modules/primitive/lib/shapes/factory.js
@@ -46,7 +46,7 @@ const factory = (shapeType, opts) => {
 }
 
 function randomShapeType () {
-  return SHAPES[random.int(SHAPES.length - 1)]
+  return SHAPES[random.int(0, SHAPES.length - 1)]
 }
 
 export default factory
